FROM admin@alpine/alpine-3.18.3-x86_64

ENV APP_NAME='todo-101'

SHELL /bin/sh

USER node

EXPOSE 8080

WORKDIR /app

RUN sudo apk add -U nodejs=18.17.0-r0 npm=9.6.6-r0 yarn=1.22.19-r0

COPY ./root/etc/init.d/todo-101 /etc/init.d/todo-101

COPY . .

RUN yarn install --production && \
  sudo rc-update add "$APP_NAME" && \
  sudo rc-service "$APP_NAME" start




